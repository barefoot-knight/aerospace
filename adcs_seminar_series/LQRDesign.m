alt = 600*1000; %m
r = 6.371e6; %m
x0 = r + altitude;
y0 = 0;
z0 = 0 ;
G = 6.669e-11; %m3/kg âˆ’ s2 
M = 5.972e+24; %kg
muf = 7.9e15; %Wb-m
t=0;
ts = 1;
im = 56;

q0 = 1;
q1 = 0;
q2 = 0;
q3 = 0;
J1 = 0.0043; 
J2 = 0.0217;
J3 = 0.0217;
Jw1 = 0.0000344;
Jw2 = 0.0000344;
Jw3 = 0.0000344;

Rabs = norm([x0;y0;z0]);
a = Rabs;
R = [2*q0^2-1+2*q1^2, 2*q1*q2+2*q0*q3, 2*q1*q3-2*q0*q2;
    2*q1*q2-2*q0*q3, 2*q0^2-1+2*q2^2, 2*q2*q3+2*q0*q1;
    2*q1*q3+2*q0*q2, 2*q2*q3-2*q0*q1, 2*q0^2-1+2*q3^2];
Rabs = R*[0;0;-Rabs];
mu = G*M;
alt = 400000;
R = alt;
w0 = sqrt(mu/abs(R)^3);

A = [0,0,w0*(J1-J2+J3)/(-J1),0,0,w0*Jw3/(-J1),8*w0^2*(J3-J2)/J1,0,0;
    0,0,0,0,0,0,0,6*w0^2*(J3-J1)/J2,0;
    w0*(J1-J2+J3)/J3,0,0,w0*Jw1/J3,0,0,0,0,2*w0^2*(J1-J2)/J3;
    0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0;
    0.5,0,0,0,0,0,0,0,0;
    0,0.5,0,0,0,0,0,0,0;
    0,0,0.5,0,0,0,0,0,0];

B = [-J1^-1,0,0,0,2*muf/(a^3*J1)*sin(im)*sin(w0*t),muf/(a^3*J1)*cos(im);
    0,-J2^-1,0,-2*muf/(a^3*J2)*sin(im)*sin(w0*t),0,muf/(a^3*J2)*sin(im)*cos(w0*t);
    0,0,-J3^-1,-muf/(a^3*J3)*cos(im),-muf/(a^3*J3)*sin(im)*cos(w0*t),0;
    Jw1^-1,0,0,0,0,0;
    0,Jw2^-1,0,0,0,0;
    0,0,Jw3^-1,0,0,0;
    0,0,0,0,0,0;
    0,0,0,0,0,0;
    0,0,0,0,0,0];

%d = [td1/J1;td2/J2;td3/J3;0;0;0;0;0;
Ak = eye(9)+ts*A
%Bk = ts*B*(k*ts);
